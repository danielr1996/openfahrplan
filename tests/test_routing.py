import pytest

from openfahrplan.lib.raptor import raptor_route
from openfahrplan import feed, raptor_index


@pytest.mark.parametrize(
    "src,dst,expected",
    [
        ("Nürnberg Gustav Adolf Straße", "Burfarrnbach Ost",            ['86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '139.T3.11-1-j25-1.4.R',
                                                                         '139.T3.11-1-j25-1.4.R',
                                                                         '139.T3.11-1-j25-1.4.R',
                                                                         '139.T3.11-1-j25-1.4.R',
                                                                         '139.T3.11-1-j25-1.4.R',
                                                                         '139.T3.11-1-j25-1.4.R',
                                                                         '139.T3.11-1-j25-1.4.R',
                                                                         '139.T3.11-1-j25-1.4.R',
                                                                         '139.T3.11-1-j25-1.4.R',
                                                                         '139.T3.11-1-j25-1.4.R',
                                                                         '139.T3.11-1-j25-1.4.R',
                                                                         '2.T3.23-172-j25-1.1.H',
                                                                         '2.T3.23-172-j25-1.1.H',
                                                                         '2.T3.23-172-j25-1.1.H',
                                                                         '2.T3.23-172-j25-1.1.H',
                                                                         '2.T3.23-172-j25-1.1.H',
                                                                         '2.T3.23-172-j25-1.1.H',
                                                                         '2.T3.23-172-j25-1.1.H']),
        ("Nürnberg Gustav Adolf Straße", "Nürnberg Deichslerstraße",    ['86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '22.T0.17-708-j25-5.1.H',
                                                                         '22.T0.17-708-j25-5.1.H']),
        ("Nürnberg Gustav Adolf Straße", "Nürnberg Plärrer",            ['86.UG.11-3-j25-1.2.H', '86.UG.11-3-j25-1.2.H', '86.UG.11-3-j25-1.2.H']),
        ("Nürnberg Gustav Adolf Straße", "Nürnberg Gostenhof",          ['86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '139.T3.11-1-j25-1.4.R']),
        ("Nürnberg Gustav Adolf Straße", "Reichenschwand",              ['86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '22.T0.17-708-j25-5.1.H',
                                                                         '22.T0.17-708-j25-5.1.H',
                                                                         '22.T0.17-708-j25-5.1.H',
                                                                         '22.T0.17-708-j25-5.1.H',
                                                                         '22.T0.17-708-j25-5.1.H',
                                                                         '22.T0.17-708-j25-5.1.H',
                                                                         '22.T0.17-708-j25-5.1.H',
                                                                         '22.T0.17-708-j25-5.1.H',
                                                                         '16.T0.2-30-B-j25-1.35.H',
                                                                         '16.T0.2-30-B-j25-1.35.H',
                                                                         '16.T0.2-30-B-j25-1.35.H',
                                                                         '16.T0.2-30-B-j25-1.35.H',
                                                                         '16.T0.2-30-B-j25-1.35.H',
                                                                         '16.T0.2-30-B-j25-1.35.H']),
        ("Nürnberg Gustav Adolf Straße", "Altschauerberg Feuerwehrhaus",['86.UG.11-3-j25-1.2.H',
                                                                         '86.UG.11-3-j25-1.2.H',
                                                                         '43.T0.1-1-j25-1.142.R',
                                                                         '43.T0.1-1-j25-1.142.R',
                                                                         '43.T0.1-1-j25-1.142.R',
                                                                         '43.T0.1-1-j25-1.142.R',
                                                                         '43.T0.1-1-j25-1.142.R',
                                                                         '43.T0.1-1-j25-1.142.R',
                                                                         '43.T0.1-1-j25-1.142.R',
                                                                         '35.T2.33-286-j25-1.3.R',
                                                                         '35.T2.33-286-j25-1.3.R',
                                                                         '35.T2.33-286-j25-1.3.R',
                                                                         '35.T2.33-286-j25-1.3.R',
                                                                         '2.T0.53-203-E-j25-1.2.H',
                                                                         '2.T0.53-203-E-j25-1.2.H',
                                                                         '2.T0.53-203-E-j25-1.2.H',
                                                                         '2.T0.53-203-E-j25-1.2.H',
                                                                         '2.T2.63-245-j25-1.22.H',
                                                                         '2.T2.63-245-j25-1.22.H',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '12.T2.63-127-j25-1.26.R',
                                                                         '1320005.T0.63-132-j25-1.1.H',
                                                                         '1320005.T0.63-132-j25-1.1.H',
                                                                         '1320005.T0.63-132-j25-1.1.H',
                                                                         '1320005.T0.63-132-j25-1.1.H',
                                                                         '1320005.T0.63-132-j25-1.1.H',
                                                                         '1320005.T0.63-132-j25-1.1.H',
                                                                         '1320005.T0.63-132-j25-1.1.H',
                                                                         '1320005.T0.63-132-j25-1.1.H']),
],
)

def test_routing(src, dst, expected):
    res = raptor_route(raptor_index,feed.gtfs_find_station(src,limit=1)["stop_id"].squeeze() , feed.gtfs_find_station(dst,limit=1)["stop_id"].squeeze())
    assert res["trips"] == expected
